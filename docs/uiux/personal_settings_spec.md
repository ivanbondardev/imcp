# Personal Settings Specification

–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞.

---

## Scope / Non-scope (–¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤–æ–≥–æ —Ä–µ–≤ º—é)

**Scope (P0):**
- –ó–º–µ–Ω—à–µ–Ω–Ω—è —à—É–º—É (notifications) + –±–∞–∑–æ–≤—ñ –≤–ø–æ–¥–æ–±–∞–Ω–Ω—è —Ä–æ–±–æ—á–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
- –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è inbox/views –±–µ–∑ –∑–º—ñ–Ω–∏ –±—ñ–∑–Ω–µ—Å‚Äë–ø—Ä–æ—Ü–µ—Å—É

**Non-scope (P1+):**
- –ó–º—ñ–Ω–∞ approval gates / state machine / required fields (—Ü–µ –Ω–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞)

---

## MVP (P0) vs Next (P1)

**P0:**
- Quiet hours + locked critical events
- Inbox display (—Ñ—ñ–ª—å—Ç—Ä–∏/—Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è/–∫–æ–ª–æ–Ω–∫–∏)
- UI density

**P1:**
- –†–æ–∑—à–∏—Ä–µ–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞ –Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ–π (–ø–æ case_type, –ø–æ —Ä–æ–ª—ñ, –ø–æ SLA tiers)

---

## Entry points / Deep links

- `/settings/personal` (–≤—Ö—ñ–¥ –∑ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó)

---

## –ú–µ—Ç–∞

Personal Settings ‚Äî —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∞–¥–∞–ø—Ç–∞—Ü—ñ—ó —Ä–æ–±–æ—á–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ç–∞ –∑–º–µ–Ω—à–µ–Ω–Ω—è –∫–æ–≥–Ω—ñ—Ç–∏–≤–Ω–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.

### –û—Å–Ω–æ–≤–Ω—ñ —Ü—ñ–ª—ñ
- **–ó–º–µ–Ω—à–µ–Ω–Ω—è —à—É–º—É**: —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è
- **–®–≤–∏–¥–∫—ñ—Å—Ç—å —Ä–µ–∞–∫—Ü—ñ—ó**: –ø—Ä—ñ–æ—Ä–∏—Ç–µ–∑—É–≤–∞—Ç–∏ critical events
- **–ê–¥–∞–ø—Ç–∞—Ü—ñ—è**: –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ inbox —Ç–∞ UI –ø—ñ–¥ —Å–µ–±–µ
- **–ó—Ä—É—á–Ω—ñ—Å—Ç—å**: –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —à–∞–±–ª–æ–Ω–∏

---

## –©–æ Settings –∑–º—ñ–Ω—é—é—Ç—å

| –ó–º—ñ–Ω—é—î—Ç—å—Å—è | –Ø–∫ —Å–∞–º–µ |
|------------|---------|
| Notifications | –ö–∞–Ω–∞–ª–∏, —Ç–∏–ø–∏ –ø–æ–¥—ñ–π, quiet hours |
| Inbox display | –§—ñ–ª—å—Ç—Ä–∏, —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è, –∫–æ–ª–æ–Ω–∫–∏ |
| Draft templates | –®–∞–±–ª–æ–Ω–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å |
| UI density | Compact / Comfortable |

---

## –©–æ Settings –ù–ï –∑–º—ñ–Ω—é—é—Ç—å

| –ù–ï –∑–º—ñ–Ω—é—î—Ç—å—Å—è | –ü—Ä–∏—á–∏–Ω–∞ |
|---------------|---------|
| State machine | –ë—ñ–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å —î–¥–∏–Ω–∏–π |
| Approval gates | –û–±–æ–≤'—è–∑–∫–æ–≤—ñ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ñ —Ç–æ—á–∫–∏ |
| Required fields | –í–∏–∑–Ω–∞—á–∞—é—Ç—å—Å—è case_type |
| RLS policies | –ü—Ä–∞–≤–∞ –≤—ñ–¥ —Ä–æ–ª—ñ |
| SLA deadlines | –ë—ñ–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ |

---

## –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

### Notifications
- **–ö–∞–Ω–∞–ª–∏**: In-app, Email (instant/digest), Messenger (MVP)
- **–¢–∏–ø–∏ –ø–æ–¥—ñ–π**: Critical (locked), Operational, Informational
- **Quiet hours**: start/end time + critical override

**Critical events** (–Ω–µ –º–æ–∂–Ω–∞ –≤–∏–º–∫–Ω—É—Ç–∏):
- Approval required ‚Äî –∑–∞–≤–∂–¥–∏ ON

### Inbox & Views
- Default filters: My cases only, At risk first, Pending approvals first
- Default sorting
- Visible columns

### Draft Templates
–®–∞–±–ª–æ–Ω–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∑ placeholders:
- `{{case_id}}`, `{{client_name}}`, `{{quote_total}}` —Ç–æ—â–æ

### UI Preferences (MVP)
- Density: compact / comfortable
- Panel states
- Theme

---

## Notifications ‚Äî Event Types

> ‚ö†Ô∏è –í–∞–∂–ª–∏–≤–æ: –Ω–∏–∂—á–µ ‚Äî **–∫–ª—é—á—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ–π** (product-level).  
> –ö–∞–Ω–æ–Ω—ñ—á–Ω—ñ audit-–ø–æ–¥—ñ—ó –¥–ª—è Timeline –∂–∏–≤—É—Ç—å —É `case_events.event_type` —ñ –º–∞—é—Ç—å —Ñ–æ—Ä–º–∞—Ç `UPPER_SNAKE_CASE` (–¥–∏–≤. `docs/core/02_core_data_model.md#4-event-taxonomy`).
>
> Mapping —Ä–æ–±–∏–º–æ –Ω–∞ —Ä—ñ–≤–Ω—ñ UI/notification-service:
> - `approval_required` ‚Üí `APPROVAL_CREATED` (–∞–±–æ derived condition ‚Äú—î pending approvals‚Äù)
> - `state_changed` ‚Üí `STATE_CHANGED`
> - `doc_uploaded` ‚Üí `DOC_UPLOADED`
> - `integration_failed` ‚Üí `INTEGRATION_FAILED`
> - `ai_draft_generated` ‚Üí `AI_RUN_COMPLETED` (run_type=GENERATE) / –∞–±–æ derived –≤—ñ–¥ –ø–æ—è–≤–∏ draft —É `cases.computed.*`

### Critical
- `approval_required` ‚Äî üîí locked ON
- `sla_risk_24h`
- `data_conflict`

### Operational
- `case_assigned`
- `state_changed`
- `doc_uploaded`
- `integration_failed`

### Informational
- `automation_completed`
- `ai_draft_generated`

---

## Quiet Hours

–†–µ–∂–∏–º —Ç–∏—à—ñ –∑ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—é:
- –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ start/end time
- Critical events –≤—Å–µ –æ–¥–Ω–æ –ø—Ä–∏—Ö–æ–¥—è—Ç—å (critical_override locked ON)

Timezone –±–µ—Ä–µ—Ç—å—Å—è –∑ Profile.

---

## UX –ø—Ä–∏–Ω—Ü–∏–ø–∏

### –®–≤–∏–¥–∫–æ
–ú—ñ–Ω—ñ–º—É–º –∫–ª—ñ–∫—ñ–≤ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å.

### –ë–µ–∑–ø–µ—á–Ω–æ
–ù–µ –º–æ–∂–Ω–∞ –≤–∏–º–∫–Ω—É—Ç–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ñ —Ç–æ—á–∫–∏.

### –ü—Ä–æ–∑–æ—Ä–æ
–û—á–µ–≤–∏–¥–Ω–æ —â–æ –∑–º—ñ–Ω–∏—Ç—å—Å—è.

### –í—ñ–¥–Ω–æ–≤–ª—é–≤–∞–Ω–æ
Reset to defaults –¥–ª—è –∫–æ–∂–Ω–æ—ó —Å–µ–∫—Ü—ñ—ó.

---

## Save Behavior

Explicit save –∑ unsaved indicator:
- Button disabled —è–∫—â–æ –Ω–µ–º–∞—î –∑–º—ñ–Ω
- "Unsaved changes" badge
- Toast –ø—ñ—Å–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
- Error handling –∑ retry

---

## Templates

### Placeholders
Whitelist –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö placeholders:
- case_id, case_type, client_name, client_contact
- route_origin, route_destination
- sla_date, quote_total, quote_validity

Unknown placeholders ‚Üí warning –ø—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ.
Missing data ‚Üí warning –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ.

---

## Core –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

–î–∏–≤–∏—Å—å [00_shared_mental_model.md](../core/00_shared_mental_model.md) –¥–ª—è –ø—Ä–∏–Ω—Ü–∏–ø—ñ–≤:
- Fatigue-Aware Design
- Human-in-the-Loop
- Accountability

---

## Edge cases (P0)

- **–ó–∞–Ω–∞–¥—Ç–æ ‚Äú—Ç–∏—Ö–æ‚Äù**: UI –º–∞—î –ø–æ–ø–µ—Ä–µ–¥–∂–∞—Ç–∏, —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–º–∏–∫–∞—î –≤—Å–µ –æ–∫—Ä—ñ–º locked critical (—Ä–∏–∑–∏–∫ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –≤–∞–∂–ª–∏–≤–µ)
- **Timezone/quiet hours**: —è–≤–Ω–æ –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ timezone —ñ –ø—Ä–∏–∫–ª–∞–¥ ‚Äú–∫–æ–ª–∏ –ø—Ä–∏–π–¥–µ –Ω–∞—Å—Ç—É–ø–Ω–∏–π digest‚Äù

---

## Product Acceptance Checklist (P0)

- [ ] Critical events (locked) –Ω–µ –º–æ–∂–Ω–∞ –≤–∏–º–∫–Ω—É—Ç–∏, —ñ —Ü–µ –∑—Ä–æ–∑—É–º—ñ–ª–æ –≤ UI
- [ ] Quiet hours: –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–∞—á–∏—Ç—å timezone —ñ –ø—Ä–∏–∫–ª–∞–¥ ‚Äú–∫–æ–ª–∏ –±—É–¥–µ —Ç–∏—Ö–æ/–∫–æ–ª–∏ –ø—Ä–∏–π–¥—É—Ç—å –Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó‚Äù
- [ ] –ó–º—ñ–Ω–∏ –º–∞—é—Ç—å —è–≤–Ω–∏–π unsaved indicator —ñ require explicit save
- [ ] –Ñ ‚Äúreset to defaults‚Äù (–º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ ‚Äî –¥–ª—è notifications —Ç–∞ inbox display)
- [ ] –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –Ω–µ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –∑–º—ñ–Ω—é–≤–∞—Ç–∏ state machine / approval gates / required fields
